<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Conway's Game of Life</title>
  <!--
  ---
  id: game-of-life-008
  title: Conway's Game of Life
  description: Interactive implementation of Conway's Game of Life cellular automaton with drawing, patterns, and speed control.
  category: simulation
  tags: [cellular-automaton, simulation, game-of-life, algorithm, interactive]
  difficulty: intermediate
  author: Josh Mu
  created: 2025-01-26
  updated: 2025-01-26
  estimatedTime: 1 hour
  prerequisites: [JavaScript arrays, Grid algorithms, Animation loops]
  learningObjectives:
    - Implement cellular automaton rules
    - Manage 2D grid state
    - Optimize grid computations
    - Handle user interaction with grids
  ---
  -->
  <style>
    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
    }

    body {
      font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
      background: #0a0a0a;
      color: #e5e5e5;
      display: flex;
      flex-direction: column;
      height: 100vh;
      overflow: hidden;
    }

    .header {
      padding: 1.5rem;
      background: #1a1a1a;
      border-bottom: 1px solid #333;
    }

    h1 {
      font-size: 1.75rem;
      margin-bottom: 0.5rem;
      color: #4ade80;
    }

    .controls {
      display: flex;
      gap: 1rem;
      flex-wrap: wrap;
      align-items: center;
    }

    .btn {
      padding: 0.5rem 1rem;
      border: none;
      border-radius: 0.25rem;
      font-size: 0.875rem;
      font-weight: 600;
      cursor: pointer;
      transition: all 0.2s;
    }

    .btn-primary {
      background: #4ade80;
      color: #0a0a0a;
    }

    .btn-primary:hover {
      background: #22c55e;
    }

    .btn-secondary {
      background: #333;
      color: #e5e5e5;
    }

    .btn-secondary:hover {
      background: #444;
    }

    .btn-danger {
      background: #ef4444;
      color: white;
    }

    .btn-danger:hover {
      background: #dc2626;
    }

    .control-group {
      display: flex;
      align-items: center;
      gap: 0.5rem;
    }

    .slider {
      width: 150px;
    }

    .stats {
      display: flex;
      gap: 1.5rem;
      font-size: 0.875rem;
      color: #888;
      margin-left: auto;
    }

    .canvas-container {
      flex: 1;
      display: flex;
      align-items: center;
      justify-content: center;
      background: #0a0a0a;
      overflow: hidden;
    }

    canvas {
      border: 1px solid #333;
      cursor: crosshair;
      image-rendering: pixelated;
    }

    .info {
      padding: 0.75rem 1.5rem;
      background: #1a1a1a;
      border-top: 1px solid #333;
      font-size: 0.75rem;
      color: #666;
      text-align: center;
    }

    @media (max-width: 768px) {
      .controls {
        flex-direction: column;
        align-items: flex-start;
      }

      .stats {
        margin-left: 0;
      }
    }
  </style>
</head>
<body>
  <div class="header">
    <h1>Conway's Game of Life</h1>
    <div class="controls">
      <button class="btn btn-primary" id="playBtn">Play</button>
      <button class="btn btn-secondary" id="stepBtn">Step</button>
      <button class="btn btn-danger" id="clearBtn">Clear</button>
      <button class="btn btn-secondary" id="randomBtn">Random</button>

      <div class="control-group">
        <label>Speed:</label>
        <input type="range" class="slider" id="speedSlider" min="1" max="60" value="10">
        <span id="speedValue">10</span> FPS
      </div>

      <div class="stats">
        <span>Generation: <strong id="generation">0</strong></span>
        <span>Population: <strong id="population">0</strong></span>
      </div>
    </div>
  </div>

  <div class="canvas-container">
    <canvas id="canvas"></canvas>
  </div>

  <div class="info">
    Click to draw cells • Space to play/pause • R to randomize • C to clear
  </div>

  <script>
    const canvas = document.getElementById('canvas');
    const ctx = canvas.getContext('2d');

    const CELL_SIZE = 8;
    const COLS = 100;
    const ROWS = 75;

    canvas.width = COLS * CELL_SIZE;
    canvas.height = ROWS * CELL_SIZE;

    let grid = createGrid();
    let nextGrid = createGrid();
    let isPlaying = false;
    let generation = 0;
    let fps = 10;
    let lastFrameTime = 0;
    let isDrawing = false;

    function createGrid() {
      return Array(ROWS).fill(null).map(() => Array(COLS).fill(0));
    }

    function randomizeGrid() {
      for (let row = 0; row < ROWS; row++) {
        for (let col = 0; col < COLS; col++) {
          grid[row][col] = Math.random() > 0.7 ? 1 : 0;
        }
      }
      generation = 0;
      draw();
    }

    function clearGrid() {
      grid = createGrid();
      generation = 0;
      draw();
    }

    function countNeighbors(row, col) {
      let count = 0;
      for (let i = -1; i <= 1; i++) {
        for (let j = -1; j <= 1; j++) {
          if (i === 0 && j === 0) continue;

          const newRow = (row + i + ROWS) % ROWS;
          const newCol = (col + j + COLS) % COLS;
          count += grid[newRow][newCol];
        }
      }
      return count;
    }

    function updateGrid() {
      for (let row = 0; row < ROWS; row++) {
        for (let col = 0; col < COLS; col++) {
          const neighbors = countNeighbors(row, col);
          const cell = grid[row][col];

          // Conway's rules
          if (cell === 1 && (neighbors === 2 || neighbors === 3)) {
            nextGrid[row][col] = 1;
          } else if (cell === 0 && neighbors === 3) {
            nextGrid[row][col] = 1;
          } else {
            nextGrid[row][col] = 0;
          }
        }
      }

      [grid, nextGrid] = [nextGrid, grid];
      generation++;
    }

    function draw() {
      ctx.fillStyle = '#0a0a0a';
      ctx.fillRect(0, 0, canvas.width, canvas.height);

      let population = 0;

      for (let row = 0; row < ROWS; row++) {
        for (let col = 0; col < COLS; col++) {
          if (grid[row][col] === 1) {
            population++;
            ctx.fillStyle = '#4ade80';
            ctx.fillRect(
              col * CELL_SIZE,
              row * CELL_SIZE,
              CELL_SIZE - 1,
              CELL_SIZE - 1
            );
          }
        }
      }

      document.getElementById('generation').textContent = generation;
      document.getElementById('population').textContent = population;
    }

    function animate(currentTime) {
      requestAnimationFrame(animate);

      if (!isPlaying) return;

      const elapsed = currentTime - lastFrameTime;
      const interval = 1000 / fps;

      if (elapsed > interval) {
        lastFrameTime = currentTime - (elapsed % interval);
        updateGrid();
        draw();
      }
    }

    // Mouse handling
    canvas.addEventListener('mousedown', (e) => {
      isDrawing = true;
      toggleCell(e);
    });

    canvas.addEventListener('mousemove', (e) => {
      if (isDrawing) toggleCell(e);
    });

    canvas.addEventListener('mouseup', () => {
      isDrawing = false;
    });

    function toggleCell(e) {
      const rect = canvas.getBoundingClientRect();
      const x = e.clientX - rect.left;
      const y = e.clientY - rect.top;
      const col = Math.floor(x / CELL_SIZE);
      const row = Math.floor(y / CELL_SIZE);

      if (row >= 0 && row < ROWS && col >= 0 && col < COLS) {
        grid[row][col] = 1;
        draw();
      }
    }

    // Controls
    document.getElementById('playBtn').addEventListener('click', () => {
      isPlaying = !isPlaying;
      document.getElementById('playBtn').textContent = isPlaying ? 'Pause' : 'Play';
    });

    document.getElementById('stepBtn').addEventListener('click', () => {
      updateGrid();
      draw();
    });

    document.getElementById('clearBtn').addEventListener('click', clearGrid);
    document.getElementById('randomBtn').addEventListener('click', randomizeGrid);

    document.getElementById('speedSlider').addEventListener('input', (e) => {
      fps = parseInt(e.target.value);
      document.getElementById('speedValue').textContent = fps;
    });

    // Keyboard shortcuts
    document.addEventListener('keydown', (e) => {
      if (e.code === 'Space') {
        e.preventDefault();
        document.getElementById('playBtn').click();
      } else if (e.code === 'KeyR') {
        randomizeGrid();
      } else if (e.code === 'KeyC') {
        clearGrid();
      }
    });

    // Initialize
    draw();
    animate(0);
  </script>
</body>
</html>
